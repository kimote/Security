{"ast":null,"code":"\"use strict\";var __importDefault=void 0&&(void 0).__importDefault||function(mod){return mod&&mod.__esModule?mod:{\"default\":mod};};Object.defineProperty(exports,\"__esModule\",{value:true});var react_1=__importDefault(require(\"react\"));var side_effect_1=__importDefault(require(\"./side-effect\"));var amp_context_1=require(\"./amp-context\");var head_manager_context_1=require(\"./head-manager-context\");var amp_1=require(\"./amp\");function defaultHead(){var inAmpMode=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var head=[react_1.default.createElement(\"meta\",{charSet:\"utf-8\"})];if(!inAmpMode){head.push(react_1.default.createElement(\"meta\",{name:\"viewport\",content:\"width=device-width\"}));}return head;}exports.defaultHead=defaultHead;function onlyReactElement(list,child){if(typeof child==='string'||typeof child==='number'){return list;}if(child.type===react_1.default.Fragment){return list.concat(react_1.default.Children.toArray(child.props.children).reduce(function(fragmentList,fragmentChild){if(typeof fragmentChild==='string'||typeof fragmentChild==='number'){return fragmentList;}return fragmentList.concat(fragmentChild);},[]));}return list.concat(child);}var METATYPES=['name','httpEquiv','charSet','itemProp'];function unique(){var keys=new Set();var tags=new Set();var metaTypes=new Set();var metaCategories={};return function(h){var unique=true;if(h.key&&typeof h.key!=='number'&&h.key.indexOf('$')>0){var key=h.key.slice(h.key.indexOf('$')+1);if(keys.has(key)){unique=false;}else{keys.add(key);}}switch(h.type){case'title':case'base':if(tags.has(h.type)){unique=false;}else{tags.add(h.type);}break;case'meta':for(var i=0,len=METATYPES.length;i<len;i++){var metatype=METATYPES[i];if(!h.props.hasOwnProperty(metatype))continue;if(metatype==='charSet'){if(metaTypes.has(metatype)){unique=false;}else{metaTypes.add(metatype);}}else{var category=h.props[metatype];var categories=metaCategories[metatype]||new Set();if(categories.has(category)){unique=false;}else{categories.add(category);metaCategories[metatype]=categories;}}}break;}return unique;};}function reduceComponents(headElements,props){return headElements.reduce(function(list,headElement){var headElementChildren=react_1.default.Children.toArray(headElement.props.children);return list.concat(headElementChildren);},[]).reduce(onlyReactElement,[]).reverse().concat(defaultHead(props.inAmpMode)).filter(unique()).reverse().map(function(c,i){var key=c.key||i;return react_1.default.cloneElement(c,{key:key});});}var Effect=side_effect_1.default();function Head(_ref){var children=_ref.children;return react_1.default.createElement(amp_context_1.AmpStateContext.Consumer,null,function(ampState){return react_1.default.createElement(head_manager_context_1.HeadManagerContext.Consumer,null,function(updateHead){return react_1.default.createElement(Effect,{reduceComponentsToState:reduceComponents,handleStateChange:updateHead,inAmpMode:amp_1.isInAmpMode(ampState)},children);});});}Head.rewind=Effect.rewind;exports.default=Head;","map":null,"metadata":{},"sourceType":"script"}